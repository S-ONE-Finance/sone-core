image: node:latest
stages:
  - deploy

deploy:
  tags:
    - smart-contract
  stage: deploy
  environment: develop
  only:
    - develop
  script:
    - yarn
    - yarn compile
    - echo "//registry.npmjs.org/:_authToken=${NPM_TOKEN}" > .npmrc
    - NPM_TOKEN=${NPM_TOKEN} npm publish
